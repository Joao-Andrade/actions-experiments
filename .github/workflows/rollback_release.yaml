name: Rollback versions
on:
 # - push
 push:
    branches:
      - main

env:
  GH_TOKEN: ${{ github.token }}

jobs:
  # maybe needs a step to check if release was a rollback or no
  rollback-please:
    runs-on: ubuntu-latest
    steps:
    - name: Check if rollback
      run: |
        message=$(echo "${{ github.event.head_commit.message }}" | { grep "Merge pull request #" || echo ""; } | { grep "rollback-branch" || echo ""; })
        if [ -z "$message" ]; then
          echo "Not rollback. Exiting."
          exit 0
        fi
        echo "Rollingback to version vx.y.z."
        gh release edit v1.7.0 --latest

